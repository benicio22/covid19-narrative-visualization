<!DOCTYPE html>
<html>
<script src='https://d3js.org/d3.v5.min.js'></script>
<script src="https://rawgit.com/susielu/d3-annotation/master/d3-annotation.min.js"></script>

<head>
  <meta charset="UTF-8">
  <title> CS416 - Luana M. Benicio </title>
  <link rel="stylesheet" href="style.css">
</head>

<button onclick="window.location.href = 'second_scene.html';">Next</button> 

<body>
  <h1> Scenario of COVID-19  </h1>
  <h2> Number of cases</h2>
  <p> The CDC gov website definitively stated on May 1st, 2024, that hospitals are no longer required to report any data related to the admission of patients with the Coronavirus (COVID-19) to the Department of Health and Human Services (HHS) through the CDC's National Healthcare Safety Network (NHSN). However, the CDC demands that hospitals report any data related to the pandemic voluntarily. 
The global impact of the pandemic is undeniable. Since 2020, it has significantly impacted health, economies, and the population's daily lives. This led to a surge in severe cases and mortality rates. However, the widespread vaccination campaigns have undoubtedly reduced these rates. Despite these advances, the world still faces the challenge of the ongoing circulation of the virus, with periodic surges attributed to new variants. Nevertheless, the world's health systems remain vigilant and committed to monitoring and maintaining efforts to manage the virus while addressing other public health needs. </p>
  

   
  <body onload='init()'>
  <svg width=900 height=500></svg>
    
  <script>
    
    async function init() {
    
    // Fetch the CSV data
      const response = await fetch('https://raw.githubusercontent.com/benicio22/covid19-narrative-visualization/main/covid_data.csv');
      const dataset = await response.text();

      // Parse the CSV data
      const parsedData = d3.csvParse(dataset, d3.autoType);

      // Set up the dimensions of the graph
      const margin = { top: 20, right: 20, bottom: 80, left: 80 };
      const width = 800 - margin.left - margin.right;
      const height = 400 - margin.top - margin.bottom;

      // Parse the date format
      const parseDate = d3.timeParse('%m/%d/%Y');

      // Format the date on the x-axis
      const formatDate = d3.timeFormat('%b %Y');

      // Create the x and y scales
      const xScale = d3.scaleTime().range([0, width]);
      const yScale = d3.scaleLinear().range([height, 0]);

      // Append the graph to the SVG
      const svg = d3.select('svg')
        .attr('width', width + margin.left + margin.right)
        .attr('height', height + margin.top + margin.bottom)
        .append('g')
        .attr('transform', `translate(${margin.left}, ${margin.top})`);

      // Convert date strings to date objects
      parsedData.forEach(d => {
        d.date = parseDate(d.date);
        d.cases = +d.cases;
      });

      // Set the domain of the x and y scales
      xScale.domain(d3.extent(parsedData, d => d.date));
      yScale.domain([0, 1300000]);

      // Add the x-axis
      svg.append('g')
        .attr('transform', `translate(0, ${height})`)
        .call(d3.axisBottom(xScale).tickFormat(formatDate));

      // Add the y-axis
      svg.append('g')
        .call(d3.axisLeft(yScale));

      // Adding tooltip
      var tooltip = d3.select("svg")
          .append("div")
          .style("opacity", 0)
          .attr("class", "tooltip")
          .style("background-color", "white")
          .style("border", "solid")
          .style("border-width", "1px")
          .style("border-radius", "5px")
          .style("padding", "10px");

       var mouseover = function(d) {
          tooltip
          .style("opacity", 1)
        }

        var mousemove = function (d, event) {
            tooltip
              .html("cases: " + d.cases)
              .style("left", event.pageX + "px") // Use pageX instead of d3.mouse(this)[0]
              .style("top", event.pageY + "px") // Use pageY instead of d3.mouse(this)[1]
              .style("transform", "translateX(-50%)"); // Center the tooltip horizontally
          };

        var mouseleave = function(d) {
        tooltip
          .transition()
          .duration(200)
          .style("opacity", 0)
      }

      // Add the circles to the graph
      svg.selectAll("circle")
          .data(parsedData)
          .enter()
          .append("circle")
              .attr("r", 3)
              .attr("fill", "#FFA500")
              .style("opacity", 0.6)
              .style("stroke", "white")
              .attr("cx", d => xScale(d.date))
              .attr("cy", d => yScale(d.cases))
          .on("mouseover", mouseover )
          .on("mousemove", mousemove )
          .on("mouseleave", mouseleave );

      // Add x-axis label
      svg.append('text')
        .attr('class', 'x-axis-label')
        .attr('x', width / 2)
        .attr('y', height + margin.top + 35) // Adjust the y position based on your preference
        .attr('text-anchor', 'middle') // Center the text on the x-axis
        .attr('font-size', '12px')
        .text('Period (months)');

      // Add y-axis label
      svg.append('text')
        .attr('class', 'y-axis-label')
        .attr('transform', 'rotate(-90)')
        .attr('x', -height / 2)
        .attr('y', -margin.left + 20) // Adjust the y position based on your preference
        .attr('text-anchor', 'middle') // Center the text on the y-axis
        .attr('font-size', '12px')
        .text('Cases');

      // Features of the annotation
            const annotations = [
           
            {note: {
                label: "Peak of cases related to variant Delta",
                title: " January 2022"
              }, x: 602, y: 95,
                 dx: 40, dy: 40
            }]
    
      // Add annotation to the chart
      const makeAnnotations = d3.annotation()
          .annotations(annotations)
    
      d3.select("svg")
          .append("g")
          .attr("font-size", "12px")
          .call(makeAnnotations)

      d3.selectAll("svg")
  .on("mouseover", mouseover)
  .on("mousemove", mousemove)
  .on("mouseleave", mouseleave);

    }

    // Call the init function to start the graph creation
    init();

  </script>
  <p> Note:</p>
  <p> This website meets the course requirements for CS416 - Data Visualization at the University of Illinois Urbana-Champaign. The data for this project was obtained from the World Health Organization (WHO) Coronavirus (Covid-19) Dashboard (Access data here:  <a href = https://covid19.who.int/data>WHO</a>) </p>
</body>
</html>

